=== EXPORT PART 7/10 ===

=== –ü–†–û–î–û–õ–ñ–ï–ù–ò–ï –° –ü–†–ï–î–´–î–£–©–ï–ì–û –§–ê–ô–õ–ê ===

  if (percentage >= 50) return 'text-yellow-400'
  return 'text-red-400'
})

const filteredInstruments = computed(() => {
  let filtered = allInstruments.value || []

  // –§–∏–ª—å—Ç—Ä –ø–æ —Ç–µ–∫—Å—Ç—É
  if (instrumentFilter.value) {
    const search = instrumentFilter.value.toLowerCase()
    filtered = filtered.filter(inst => {
      if (!inst) return false
      const ticker = inst.ticker || ''
      const name = inst.name || ''
      return ticker.toLowerCase().includes(search) || 
             name.toLowerCase().includes(search)
    })
  }

  // –§–∏–ª—å—Ç—Ä –ø–æ –¥–∞–Ω–Ω—ã–º
  if (dataFilter.value !== 'all') {
    filtered = filtered.filter(inst => {
      if (!inst) return false
      const candles = inst.candles_count || 0
      const coverage = inst.coverage_percentage || 0
      
      switch (dataFilter.value) {
        case 'with_data':
          return candles > 0
        case 'no_data':
          return candles === 0
        case 'poor_data':
          return candles > 0 && coverage < 50
        default:
          return true
      }
    })
  }

  return filtered
})

// –ú–µ—Ç–æ–¥—ã
async function checkSystemStatus() {
  isLoading.value = true
  loadingMessage.value = '–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã...'
  
  try {
    systemStats.value = await tradingAPI.getSystemStatistics()
    console.log('‚úÖ System stats loaded:', systemStats.value)
  } catch (error) {
    console.error('‚ùå Error loading system stats:', error)
    alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: ' + error.message)
  } finally {
    isLoading.value = false
  }
}

async function loadAllInstruments() {
  isLoading.value = true
  loadingMessage.value = '–ó–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤...'
  
  try {
    const tickers = await tradingAPI.getAvailableTickers(true, true)
    availableTickers.value = tickers
    
    // ‚úÖ –î–æ–±–∞–≤—å —ç—Ç–∏ –ª–æ–≥–∏:
    console.log('üîç RAW tickers:', tickers.slice(0, 2))  // –ø–µ—Ä–≤—ã–µ 2 —Ç–∏–∫–µ—Ä–∞
    console.log('üîç SBER data:', tickers.find(t => t.ticker === 'SBER'))
    
    allInstruments.value = tickers.map(ticker => ({
      ...ticker,
      coverage_percentage: calculateCoverage(ticker),
      latest_candle: ticker.latest_candle
    }))
    
    console.log('üîç SBER after processing:', allInstruments.value.find(t => t.ticker === 'SBER'))
    console.log('‚úÖ Instruments loaded:', allInstruments.value.length)
  } catch (error) {
    console.error('‚ùå Error loading instruments:', error)
    alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤: ' + error.message)
  } finally {
    isLoading.value = false
  }
}

async function analyzeInstrument() {
  if (!selectedTicker.value) return
  
  isLoading.value = true
  loadingMessage.value = `–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º ${selectedTicker.value}...`
  
  try {
    // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥
    const candlesResponse = await tradingAPI.getCandles(selectedTicker.value, selectedPeriod.value)
    
    if (candlesResponse && candlesResponse.candles) {
      const candles = candlesResponse.candles
      const requestedDays = selectedPeriod.value
      
      // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω
      let dateRange = null
      let maxDaysAvailable = 0
      
      if (candles.length > 0) {
        const times = candles.map(c => {
          const time = c.time || c.timestamp || c.datetime
          return typeof time === 'string' ? new Date(time) : new Date(time * 1000)
        }).sort((a, b) => a - b)
        
        const firstTime = times[0]
        const lastTime = times[times.length - 1]
        maxDaysAvailable = Math.floor((lastTime - firstTime) / (1000 * 60 * 60 * 24))
        
        dateRange = {
          start: firstTime.toISOString(),
          end: lastTime.toISOString()
        }
      }
      
      const coveragePercentage = Math.round((maxDaysAvailable / requestedDays) * 100)
      
      analysisResult.value = {
        ticker: selectedTicker.value,
        available_candles: candles.length,
        requested_days: requestedDays,
        max_days_available: maxDaysAvailable,
        coverage_percentage: Math.min(coveragePercentage, 100),
        date_range: dateRange,
        last_update: new Date().toISOString()
      }
      
      console.log('‚úÖ Analysis completed:', analysisResult.value)
    } else {
      analysisResult.value = {
        ticker: selectedTicker.value,
        available_candles: 0,
        requested_days: selectedPeriod.value,
        max_days_available: 0,
        coverage_percentage: 0,
        date_range: null,
        last_update: new Date().toISOString()
      }
    }
  } catch (error) {
    console.error('‚ùå Error analyzing instrument:', error)
    alert('–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞: ' + error.message)
  } finally {
    isLoading.value = false
  }
}

async function loadMissingData() {
  if (!selectedTicker.value) return
  
  isLoadingData.value = true
  
  try {
    const response = await tradingAPI.loadHistoricalData(
      selectedTicker.value, 
      selectedPeriod.value, 
      true
    )
    
    console.log('‚úÖ Historical data loading started:', response)
    alert(`–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è ${selectedTicker.value} –∑–∞–ø—É—â–µ–Ω–∞! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç.`)
    
    setTimeout(() => {
      analyzeInstrument()
      loadAllInstruments()
    }, 10000)
    
  } catch (error) {
    console.error('‚ùå Error loading historical data:', error)
    alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: ' + error.message)
  } finally {
    isLoadingData.value = false
  }
}

async function loadInstrumentData(ticker) {
  isLoadingData.value = true
  
  try {
    await tradingAPI.loadHistoricalData(ticker, 365, true)
    alert(`–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è ${ticker} –∑–∞–ø—É—â–µ–Ω–∞!`)
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
    setTimeout(loadAllInstruments, 5000)
  } catch (error) {
    console.error('‚ùå Error loading data for', ticker, error)
    alert(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è ${ticker}: ` + error.message)
  } finally {
    isLoadingData.value = false
  }
}

async function refreshAllData() {
  isLoading.value = true
  loadingMessage.value = '–û–±–Ω–æ–≤–ª—è–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ...'
  
  try {
    await Promise.all([
      checkSystemStatus(),
      loadAllInstruments()
    ])
  } finally {
    isLoading.value = false
  }
}

function calculateCoverage(ticker) {
  if (!ticker.candles_count || !ticker.latest_candle) return 0
  
  // –°—á–∏—Ç–∞–µ–º —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –Ω–∞–∑–∞–¥ –±—ã–ª–∞ –ø–æ—Å–ª–µ–¥–Ω—è—è —Å–≤–µ—á–∞
  const now = Date.now()
  const lastCandleTime = new Date(ticker.latest_candle).getTime()
  const daysSinceLastCandle = Math.floor((now - lastCandleTime) / (1000 * 60 * 60 * 24))
  
  // –ï—Å–ª–∏ –ø–æ—Å–ª–µ–¥–Ω—è—è —Å–≤–µ—á–∞ —Å–µ–≥–æ–¥–Ω—è –∏–ª–∏ –≤—á–µ—Ä–∞ = 100%
  if (daysSinceLastCandle <= 1) return 100
  
  // –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –±–µ–∑ —Å–≤–µ—á–µ–π —Å–Ω–∏–∂–∞–µ—Ç –ø–æ–∫—Ä—ã—Ç–∏–µ –Ω–∞ 3%
  // –ß–µ—Ä–µ–∑ 30 –¥–Ω–µ–π = 10%, —á–µ—Ä–µ–∑ 33 –¥–Ω—è = 0%
  const coverage = Math.max(0, 100 - (daysSinceLastCandle * 3))
  return Math.round(coverage)
}

function formatDate(dateString) {
  if (!dateString) return ''
  return new Date(dateString).toLocaleDateString('ru-RU', {
    year: 'numeric',
    month: 'short',
    day: 'numeric'
  })
}

function formatNumber(num) {
  if (!num) return '0'
  return new Intl.NumberFormat('ru-RU').format(num)
}

function getCoverageClass(percentage) {
  if (!percentage) return 'bg-gray-600 text-gray-300'
  if (percentage >= 80) return 'bg-green-600 text-white'
  if (percentage >= 50) return 'bg-yellow-600 text-white'
  return 'bg-red-600 text-white'
}

// Lifecycle
onMounted(async () => {
  console.log('üöÄ Data Diagnostics page mounted')
  await refreshAllData()
})
</script>

================================================================================
File: frontend/src/views/DataManagement.vue
================================================================================
<template>
  <div class="min-h-screen bg-trading-dark p-6">
    <div class="max-w-7xl mx-auto">
      <h1 class="text-3xl font-bold text-white mb-6">üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏</h1>
      
      <!-- Telegram Monitoring Control -->
      <div class="bg-trading-card rounded-lg p-6 mb-6 border border-trading-border">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-xl font-bold text-white">üîÑ Real-time –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</h2>
          <div class="flex items-center gap-3">
            <span 
              :class="monitoringStatus?.is_running ? 'text-green-400' : 'text-gray-400'"
              class="text-sm font-medium"
            >
              {{ monitoringStatus?.is_running ? 'üü¢ –ê–∫—Ç–∏–≤–µ–Ω' : '‚ö´ –û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω' }}
            </span>
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
          <div>
            <label class="block text-gray-400 text-sm mb-2">–ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ (—Å–µ–∫)</label>
            <input 
              v-model.number="monitoringInterval" 
              type="number"
              min="10"
              max="600"
              class="w-full bg-trading-dark border border-trading-border rounded px-4 py-2 text-white focus:outline-none focus:border-trading-green"
              :disabled="monitoringStatus?.is_running"
            />
          </div>
        </div>

        <div class="flex gap-4">
          <button 
            v-if="!monitoringStatus?.is_running"
            @click="startMonitoring"
            :disabled="startingMonitoring"
            class="px-6 py-3 bg-trading-green hover:bg-green-600 text-white rounded font-semibold disabled:opacity-50 transition-colors"
          >
            {{ startingMonitoring ? '‚è≥ –ó–∞–ø—É—Å–∫...' : '‚ñ∂Ô∏è –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥' }}
          </button>
          
          <button 
            v-else
            @click="stopMonitoring"
            :disabled="stoppingMonitoring"
            class="px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded font-semibold disabled:opacity-50 transition-colors"
          >
            {{ stoppingMonitoring ? '‚è≥ –û—Å—Ç–∞–Ω–æ–≤–∫–∞...' : '‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥' }}
          </button>

          <button 
            @click="getMonitoringStatus"
            class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded font-semibold transition-colors"
          >
            üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å
          </button>
        </div>

        <div v-if="monitoringStatus" class="mt-4 p-4 bg-trading-dark rounded border border-trading-border">
          <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
            <div>
              <p class="text-gray-400">Telegram –∫–ª–∏–µ–Ω—Ç</p>
              <p :class="monitoringStatus.client_connected ? 'text-green-400' : 'text-red-400'" class="font-bold">
                {{ monitoringStatus.client_connected ? '‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω' : '‚ùå –û—Ç–∫–ª—é—á–µ–Ω' }}
              </p>
            </div>
            <div>
              <p class="text-gray-400">–ê–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤</p>
              <p class="text-white font-bold">
                {{ monitoringStatus.channels?.filter(c => c.enabled).length || 0 }}
              </p>
            </div>
            <div>
              <p class="text-gray-400">–í—Å–µ–≥–æ –∫–∞–Ω–∞–ª–æ–≤</p>
              <p class="text-white font-bold">
                {{ monitoringStatus.channels?.length || 0 }}
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Channels Management -->
      <div class="bg-trading-card rounded-lg p-6 mb-6 border border-trading-border">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-xl font-bold text-white">üì± –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–∞–º–∏</h2>
          <button 
            @click="showAddChannelModal = true"
            class="px-4 py-2 bg-trading-green hover:bg-green-600 text-white rounded font-semibold transition-colors"
          >
            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–∞–Ω–∞–ª
          </button>
        </div>

        <div v-if="channels.length === 0" class="text-center py-8 text-gray-400">
          üì≠ –ù–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤
        </div>

        <div v-else class="space-y-3">
          <div 
            v-for="channel in channels" 
            :key="channel.id"
            class="bg-trading-dark rounded-lg p-4 border border-trading-border hover:border-trading-green transition-colors"
          >
            <div class="flex items-center justify-between">
              <div class="flex-1">
                <div class="flex items-center gap-3">
                  <span 
                    :class="channel.enabled ? 'text-green-400' : 'text-gray-500'"
                    class="text-2xl"
                  >
                    {{ channel.enabled ? 'üü¢' : '‚ö´' }}
                  </span>
                  <div>
                    <h3 class="text-white font-semibold">{{ channel.name }}</h3>
                    <p class="text-gray-400 text-sm">ID: {{ channel.id }}</p>
                  </div>
                </div>
                
                <div class="mt-2 grid grid-cols-3 gap-4 text-sm">
                  <div>
                    <span class="text-gray-400">–ü–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:</span>
                    <span class="text-white ml-2">{{ channel.last_message_id || 'N/A' }}</span>
                  </div>
                  <div>
                    <span class="text-gray-400">–í—Å–µ–≥–æ —Å–æ–±—Ä–∞–Ω–æ:</span>
                    <span class="text-white ml-2">{{ channel.total_collected || 0 }}</span>
                  </div>
                </div>
              </div>

              <div class="flex items-center gap-2">
                <div class="flex gap-2">
                  <button
                    @click="fetchChannelHistory(channel.id, true)"
                    :disabled="fetchingHistory[channel.id]"
                    class="flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm font-semibold transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                  >
                    {{ fetchingHistory[channel.id] ? '‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...' : 'üîÑ –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è' }}
                  </button>
                  
                  <button
                    @click="fetchChannelHistory(channel.id, false)"
                    :disabled="fetchingHistory[channel.id]"
                    class="flex-1 px-3 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded text-sm font-semibold transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                  >
                    {{ fetchingHistory[channel.id] ? '‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...' : 'üì• –ò—Å—Ç–æ—Ä–∏—è' }}
                  </button>
                </div>

                <button 
                  v-if="channel.enabled"
                  @click="toggleChannel(channel.id, false)"
                  class="px-4 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded text-sm transition-colors"
                  title="–û—Ç–∫–ª—é—á–∏—Ç—å"
                >
                  ‚è∏Ô∏è
                </button>
                <button 
                  v-else
                  @click="toggleChannel(channel.id, true)"
                  class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded text-sm transition-colors"
                  title="–í–∫–ª—é—á–∏—Ç—å"
                >
                  ‚ñ∂Ô∏è
                </button>

                <button 
                  @click="confirmDeleteChannel(channel)"
                  class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded text-sm transition-colors"
                  title="–£–¥–∞–ª–∏—Ç—å"
                >
                  üóëÔ∏è
                </button>
              </div>
            </div>

            <!-- Expandable Messages Section -->
            <div v-if="expandedChannel === channel.id" class="mt-4 space-y-4">
              <!-- Tabs -->
              <div class="flex gap-2 border-b border-trading-border">
                <button 
                  @click="channelTab = 'raw'"
                  :class="[
                    'px-4 py-2 text-sm',
                    channelTab === 'raw' ? 'border-b-2 border-trading-green text-white' : 'text-gray-400'
                  ]"
                >
                  üìù –°—ã—Ä—ã–µ ({{ channelMessages[channel.id]?.raw?.length || 0 }})
                </button>
                <button 
                  @click="channelTab = 'parsed'"
                  :class="[
                    'px-4 py-2 text-sm',
                    channelTab === 'parsed' ? 'border-b-2 border-trading-green text-white' : 'text-gray-400'
                  ]"
                >
                  ‚úÖ –†–∞–∑–æ–±—Ä–∞–Ω–Ω—ã–µ ({{ channelMessages[channel.id]?.parsed?.length || 0 }})
                </button>
                <button 
                  @click="channelTab = 'signals'"
                  :class="[
                    'px-4 py-2 text-sm',
                    channelTab === 'signals' ? 'border-b-2 border-trading-green text-white' : 'text-gray-400'
                  ]"
                >
                  üéØ –°–∏–≥–Ω–∞–ª—ã ({{ channelMessages[channel.id]?.signals?.length || 0 }})
                </button>
              </div>

              <!-- Content -->
              <div class="max-h-96 overflow-y-auto">
                <!-- Raw Messages -->
                <div v-if="channelTab === 'raw'" class="space-y-2">
                  <div v-if="!channelMessages[channel.id]?.raw?.length" class="text-center py-4 text-gray-400">
                    –ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π
                  </div>
                  <div 
                    v-for="msg in channelMessages[channel.id]?.raw || []" 
                    :key="msg.id"
                    class="bg-gray-800 p-3 rounded text-sm"
                  >
                    <div class="flex justify-between text-xs text-gray-400 mb-1">
                      <span>{{ formatDate(msg.timestamp) }}</span>
                      <span :class="msg.is_processed ? 'text-green-400' : 'text-yellow-400'">
                        {{ msg.is_processed ? '‚úÖ –†–∞–∑–æ–±—Ä–∞–Ω–æ' : '‚è≥ –û–∂–∏–¥–∞–µ—Ç' }}
                      </span>
                    </div>
                    <div class="text-white whitespace-pre-wrap">{{ msg.text }}</div>
                  </div>
                </div>

                <!-- Parsed Messages -->
                <div v-if="channelTab === 'parsed'" class="space-y-2">
                  <div v-if="!channelMessages[channel.id]?.parsed?.length" class="text-center py-4 text-gray-400">
                    –ù–µ—Ç —Ä–∞–∑–æ–±—Ä–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
                  </div>
                  <div 
                    v-for="msg in channelMessages[channel.id]?.parsed || []" 
                    :key="msg.id"
                    class="bg-gray-800 p-3 rounded text-sm"
                  >
                    <div class="text-xs text-gray-400 mb-1">
                      {{ formatDate(msg.timestamp) }}
                    </div>
                    <div class="text-white whitespace-pre-wrap">{{ msg.text }}</div>
                  </div>
                </div>

                <!-- Signals -->
                <div v-if="channelTab === 'signals'" class="space-y-2">
                  <div v-if="!channelMessages[channel.id]?.signals?.length" class="text-center py-4 text-gray-400">
                    –ù–µ—Ç —Å–∏–≥–Ω–∞–ª–æ–≤
                  </div>
                  <div 
                    v-for="signal in channelMessages[channel.id]?.signals || []" 
                    :key="signal.id"
                    class="bg-gray-800 p-3 rounded text-sm"
                  >
                    <div class="flex items-center gap-2 mb-1">
                      <span class="text-white font-bold">{{ signal.ticker }}</span>
                      <span :class="signal.direction === 'long' ? 'text-green-400' : 'text-red-400'">
                        {{ signal.direction === 'long' ? 'üìà LONG' : 'üìâ SHORT' }}
                      </span>
                      <span class="text-gray-400">{{ signal.price }}‚ÇΩ</span>
                    </div>
                    <div class="flex gap-3 text-xs text-gray-400">
                      <span v-if="signal.target_price">üéØ {{ signal.target_price }}‚ÇΩ</span>
                      <span v-if="signal.stop_price">üõë {{ signal.stop_price }}‚ÇΩ</span>
                    </div>
                    <div class="text-xs text-gray-400 mt-1">
                      {{ formatDate(signal.timestamp) }} ‚Ä¢ {{ signal.author }}
                    </div>
                  </div>
                </div>
              </div>

              <button 
                @click="loadMoreChannelData(channel.id)"
                :disabled="loadingMore[channel.id]"
                class="w-full px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded text-sm disabled:opacity-50"
              >
                {{ loadingMore[channel.id] ? '‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...' : '–ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â—ë' }}
              </button>
            </div>

            <!-- Toggle Button -->
            <button 
              @click="toggleChannelExpand(channel.id)"
              class="mt-2 text-sm text-blue-400 hover:text-blue-300"
            >
              {{ expandedChannel === channel.id ? '‚ñ≤ –°–∫—Ä—ã—Ç—å' : '‚ñº –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è' }}
            </button>
          </div>
        </div>
      </div>

      <!-- Message Parser -->
      <div class="bg-trading-card rounded-lg p-6 mb-6 border border-trading-border">
        <h2 class="text-xl font-bold text-white mb-4">üîÑ Message Parser</h2>
        
        <div class="mb-4">
          <label class="block text-gray-400 text-sm mb-2">–õ–∏–º–∏—Ç –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞</label>
          <input 
            v-model.number="parseLimit" 
            type="number" 
            class="w-full md:w-64 bg-trading-dark border border-trading-border rounded px-4 py-2 text-white focus:outline-none focus:border-trading-green"
            placeholder="500"
          />
        </div>
        
        <div class="flex gap-4 flex-wrap">
          <button 
            @click="parseMessages"
            :disabled="parsing"
            class="px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white rounded font-semibold disabled:opacity-50 transition-colors"
          >
            {{ parsing ? 'üîÑ –ü–∞—Ä—Å–∏–Ω–≥...' : 'üîÑ –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥' }}
          </button>
          
          <button 
            @click="getUnparsedCount"
            class="px-6 py-3 bg-yellow-600 hover:bg-yellow-700 text-white rounded font-semibold transition-colors"
          >
            üìã –ù–µ—Ä–∞–∑–æ–±—Ä–∞–Ω–Ω—ã–µ
          </button>

          <button 
            @click="processSignals"
            :disabled="processing"
            class="px-6 py-3 bg-trading-green hover:bg-green-600 text-white rounded font-semibold disabled:opacity-50 transition-colors"
          >
            {{ processing ? '‚è≥ –û–±—Ä–∞–±–æ—Ç–∫–∞...' : '‚ñ∂Ô∏è –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Å–∏–≥–Ω–∞–ª—ã' }}
          </button>
          
          <button 
            @click="getSignalStats"
            class="px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded font-semibold transition-colors"
          >
            üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤
          </button>
        </div>
        
        <div v-if="unparsedCount !== null" class="mt-4 p-4 bg-trading-dark rounded border border-trading-border">
          <p class="text-white text-xl">
            –ù–µ—Ä–∞–∑–æ–±—Ä–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π: <span class="text-yellow-400 font-bold">{{ unparsedCount }}</span>
          </p>
        </div>

        <div v-if="signalStats" class="mt-4 p-4 bg-trading-dark rounded border border-trading-border">
          <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div>
              <p class="text-gray-400 text-sm">–í—Å–µ–≥–æ —Å–∏–≥–Ω–∞–ª–æ–≤</p>
              <p class="text-white text-2xl font-bold">{{ signalStats.total_signals || 0 }}</p>
            </div>
            <div>
              <p class="text-gray-400 text-sm">–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–∏–∫–µ—Ä–æ–≤</p>
              <p class="text-white text-2xl font-bold">{{ signalStats.unique_tickers || 0 }}</p>
            </div>
            <div>
              <p class="text-gray-400 text-sm">–ó–∞ 24 —á–∞—Å–∞</p>
              <p class="text-white text-2xl font-bold">{{ signalStats.last_24h || 0 }}</p>
            </div>
            <div>
              <p class="text-gray-400 text-sm">–¢–æ–ø —Ç–∏–∫–µ—Ä–æ–≤</p>
              <p class="text-white text-2xl font-bold">{{ signalStats.top_tickers?.length || 0 }}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Add Channel Modal -->
      <div v-if="showAddChannelModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50">
        <div class="bg-trading-card rounded-lg p-6 max-w-md w-full mx-4 border border-trading-border">
          <h3 class="text-xl font-bold text-white mb-4">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–∞–Ω–∞–ª</h3>
          
          <div class="space-y-4">
            <div>
              <label class="block text-gray-400 text-sm mb-2">ID –∫–∞–Ω–∞–ª–∞</label>
              <input 
                v-model.number="newChannel.id"
                type="number"
                class="w-full bg-trading-dark border border-trading-border rounded px-4 py-2 text-white focus:outline-none focus:border-trading-green"
                placeholder="2198949181 –∏–ª–∏ -2907147155"
              />
            </div>

            <div>
              <label class="block text-gray-400 text-sm mb-2">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
              <input 
                v-model="newChannel.name"
                type="text"
                class="w-full bg-trading-dark border border-trading-border rounded px-4 py-2 text-white focus:outline-none focus:border-trading-green"
                placeholder="Trading Channel"
              />
            </div>

            <div class="flex items-center gap-2">
              <input 
                v-model="newChannel.enabled"
                type="checkbox"
                id="newChannelEnabled"
                class="w-4 h-4"
              />
              <label for="newChannelEnabled" class="text-gray-400 text-sm">–í–∫–ª—é—á–∏—Ç—å —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è</label>
            </div>
          </div>

          <div class="flex gap-3 mt-6">
            <button 
              @click="addChannel"
              :disabled="!newChannel.id || !newChannel.name || addingChannel"
              class="flex-1 px-4 py-2 bg-trading-green hover:bg-green-600 text-white rounded font-semibold disabled:opacity-50 transition-colors"
            >
              {{ addingChannel ? '‚è≥ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ...' : '‚úÖ –î–æ–±–∞–≤–∏—Ç—å' }}
            </button>
            <button 
              @click="closeAddChannelModal"
              class="flex-1 px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded font-semibold transition-colors"
            >
              ‚ùå –û—Ç–º–µ–Ω–∞
            </button>
          </div>
        </div>
      </div>

      <!-- Notifications -->
      <div v-if="notification" class="fixed bottom-4 right-4 max-w-sm z-50">
        <div 
          :class="notification.type === 'success' ? 'bg-green-600' : 'bg-red-600'"
          class="text-white px-6 py-4 rounded-lg shadow-lg"
        >
          {{ notification.message }}
        </div>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue'
import { tradingAPI } from '../services/api'

const monitoringInterval = ref(60)
const parseLimit = ref(500)
const historyLimit = ref(500)

const startingMonitoring = ref(false)
const stoppingMonitoring = ref(false)
const parsing = ref(false)
const processing = ref(false)
const addingChannel = ref(false)

const monitoringStatus = ref(null)
const channels = ref([])
const unparsedCount = ref(null)
const signalStats = ref(null)
const notification = ref(null)
const fetchingHistory = ref({})
const loadingMore = ref({})

const showAddChannelModal = ref(false)
const newChannel = ref({
  id: null,
  name: '',
  enabled: true
})

const expandedChannel = ref(null)
const channelTab = ref('raw')
const channelMessages = ref({})
const channelOffsets = ref({})

function formatDate(dateString) {
  const date = new Date(dateString)
  return date.toLocaleString('ru-RU', {
    day: '2-digit',
    month: '2-digit',
    year: 'numeric',
    hour: '2-digit',
    minute: '2-digit'
  })
}

function showNotification(message, type = 'success') {
  notification.value = { message, type }
  setTimeout(() => {
    notification.value = null
  }, 4000)
}

async function getMonitoringStatus() {
  try {
    const response = await tradingAPI.telegram.getStatus()
    monitoringStatus.value = response
    
    if (response.channels) {
      channels.value = response.channels
    }
  } catch (error) {
    console.error('Failed to get monitoring status:', error)
    showNotification('‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞', 'error')
  }
}

async function startMonitoring() {
  try {
    startingMonitoring.value = true
    await tradingAPI.telegram.startMonitoring(monitoringInterval.value)
    showNotification('‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–ø—É—â–µ–Ω')
    await getMonitoringStatus()
  } catch (error) {
    console.error('Failed to start monitoring:', error)
    showNotification(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error')
  } finally {
    startingMonitoring.value = false
  }
}

async function stopMonitoring() {
  try {
    stoppingMonitoring.value = true
    await tradingAPI.telegram.stopMonitoring()
    showNotification('‚èπÔ∏è –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω')
    await getMonitoringStatus()
  } catch (error) {
    console.error('Failed to stop monitoring:', error)
    showNotification(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error')
  } finally {
    stoppingMonitoring.value = false
  }
}

async function fetchChannelHistory(channelId, useLatest = false) {
  try {
    fetchingHistory.value[channelId] = true
    
    let response
    if (useLatest) {
      response = await tradingAPI.telegram.fetchLatestMessages(channelId, historyLimit.value)
    } else {
      response = await tradingAPI.telegram.fetchHistory(channelId, historyLimit.value)
    }
    
    showNotification(`‚úÖ –°–æ–±—Ä–∞–Ω–æ ${response.messages_collected} —Å–æ–æ–±—â–µ–Ω–∏–π`)
    await getUnparsedCount()
    
    if (response.messages_collected > 0) {
      showNotification('üîÑ –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥...')
      setTimeout(async () => {
        await parseMessages()
      }, 1000)
    }
  } catch (error) {
    console.error('Failed to fetch history:', error)
    showNotification(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error')
  } finally {
    fetchingHistory.value[channelId] = false
  }
}

async function toggleChannel(channelId, enable) {
  try {
    if (enable) {
      await tradingAPI.telegram.enableChannel(channelId)
      showNotification('‚úÖ –ö–∞–Ω–∞–ª –≤–∫–ª—é—á–µ–Ω')
    } else {
      await tradingAPI.telegram.disableChannel(channelId)
      showNotification('‚è∏Ô∏è –ö–∞–Ω–∞–ª –æ—Ç–∫–ª—é—á–µ–Ω')
    }
    await getMonitoringStatus()
  } catch (error) {
    console.error('Failed to toggle channel:', error)
    showNotification(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error')
  }
}

async function addChannel() {
  try {
    addingChannel.value = true
    await tradingAPI.telegram.addChannel(
      newChannel.value.id,
      newChannel.value.name,
      newChannel.value.enabled
    )
    showNotification('‚úÖ –ö–∞–Ω–∞–ª –¥–æ–±–∞–≤–ª–µ–Ω')
    closeAddChannelModal()
    await getMonitoringStatus()
  } catch (error) {
    console.error('Failed to add channel:', error)
    showNotification(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error')
  } finally {
    addingChannel.value = false
  }
}

function closeAddChannelModal() {
  showAddChannelModal.value = false
  newChannel.value = {
    id: null,
    name: '',
    enabled: true
  }
}

async function confirmDeleteChannel(channel) {
  if (confirm(`–£–¥–∞–ª–∏—Ç—å –∫–∞–Ω–∞–ª "${channel.name}"?`)) {
    try {
      await tradingAPI.telegram.deleteChannel(channel.id)
      showNotification('üóëÔ∏è –ö–∞–Ω–∞–ª —É–¥–∞–ª–µ–Ω')
      await getMonitoringStatus()
    } catch (error) {
      console.error('Failed to delete channel:', error)
      showNotification(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error')
    }
  }
}

function toggleChannelExpand(channelId) {
  if (expandedChannel.value === channelId) {
    expandedChannel.value = null
  } else {
    expandedChannel.value = channelId
    channelTab.value = 'raw'
    loadChannelData(channelId)
  }
}

async function loadChannelData(channelId) {
  try {
    channelOffsets.value[channelId] = {
      raw: 0,
      parsed: 0,
      signals: 0
    }

    const [raw, parsed, signals] = await Promise.all([
      tradingAPI.telegram.getChannelMessages(channelId, 10, 0, false),
      tradingAPI.telegram.getChannelMessages(channelId, 10, 0, true),
      tradingAPI.telegram.getChannelSignals(channelId, 10, 0)
    ])

    channelMessages.value[channelId] = {
      raw: raw.messages || [],
      parsed: parsed.messages || [],
      signals: signals.signals || []
    }
  } catch (error) {
    console.error('Failed to load channel data:', error)
    showNotification('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–∞', 'error')
  }
}

async function loadMoreChannelData(channelId) {
  try {
    loadingMore.value[channelId] = true
    
    const currentTab = channelTab.value
    const currentOffset = channelOffsets.value[channelId]?.[currentTab] || 0
    const newOffset = currentOffset + 10

    if (currentTab === 'raw') {
      const response = await tradingAPI.telegram.getChannelMessages(channelId, 10, newOffset, false)
      channelMessages.value[channelId].raw.push(...(response.messages || []))
    } else if (currentTab === 'parsed') {
      const response = await tradingAPI.telegram.getChannelMessages(channelId, 10, newOffset, true)
      channelMessages.value[channelId].parsed.push(...(response.messages || []))
    } else if (currentTab === 'signals') {
      const response = await tradingAPI.telegram.getChannelSignals(channelId, 10, newOffset)
      channelMessages.value[channelId].signals.push(...(response.signals || []))
    }

    if (!channelOffsets.value[channelId]) {
      channelOffsets.value[channelId] = { raw: 0, parsed: 0, signals: 0 }
    }
    channelOffsets.value[channelId][currentTab] = newOffset

  } catch (error) {
    console.error('Failed to load more data:', error)
    showNotification('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö', 'error')
  } finally {
    loadingMore.value[channelId] = false
  }
}

async function parseMessages() {
  try {
    parsing.value = true
    await tradingAPI.messages.parseAll(parseLimit.value)
    showNotification('‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –∑–∞–ø—É—â–µ–Ω')
    setTimeout(async () => {
      await getSignalStats()
      await getUnparsedCount()
    }, 3000)
  } catch (error) {
    console.error('Failed to parse messages:', error)
    showNotification(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error')
  } finally {
    parsing.value = false
  }
}

async function getUnparsedCount() {
  try {
    const response = await tradingAPI.messages.getUnparsed(1)
    unparsedCount.value = response.count
  } catch (error) {
    console.error('Failed to get unparsed count:', error)
  }
}

async function processSignals() {
  try {
    processing.value = true
    await tradingAPI.signals.process()
    showNotification('‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –∑–∞–ø—É—â–µ–Ω–∞')
    setTimeout(async () => {
      await getSignalStats()
    }, 3000)
  } catch (error) {
    console.error('Failed to process signals:', error)
    showNotification(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error')
  } finally {
    processing.value = false
  }
}

async function getSignalStats() {
  try {
    signalStats.value = await tradingAPI.getSignalsStats()
  } catch (error) {
    console.error('Failed to get signal stats:', error)
  }
}

onMounted(async () => {
  await getMonitoringStatus()
  await getUnparsedCount()
  await getSignalStats()
})
</script>

================================================================================
File: frontend/src/views/PatternsManager.vue
================================================================================
<template>
  <div class="min-h-screen bg-trading-dark p-6">
    <div class="max-w-7xl mx-auto">
      <!-- Header -->
      <div class="flex justify-between items-center mb-6">
        <div>
          <h1 class="text-3xl font-bold text-white">üéØ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º–∏</h1>
          <p class="text-gray-400 mt-1">–†–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å–∏–≥–Ω–∞–ª–æ–≤</p>
        </div>
        <div class="flex gap-3">
          <button
            @click="showCreateModal = true"
            class="px-4 py-2 bg-trading-green hover:bg-opacity-80 rounded-lg transition-colors"
          >
            ‚ûï –°–æ–∑–¥–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω
          </button>
          <button
            @click="reparseAllMessages"
            :disabled="isReparsing"
            class="px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg transition-colors disabled:opacity-50"
          >
            {{ isReparsing ? '‚è≥ –†–µ–ø–∞—Ä—Å–∏–Ω–≥...' : 'üîÑ –ü–µ—Ä–µ–ø–∞—Ä—Å–∏—Ç—å –≤—Å–µ' }}
          </button>
        </div>
      </div>

      <!-- Stats -->
      <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
        <div class="bg-trading-card rounded-lg border border-trading-border p-4">
          <div class="text-2xl font-bold text-blue-400">{{ totalPatterns }}</div>
          <div class="text-sm text-gray-400">–í—Å–µ–≥–æ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤</div>
        </div>
        <div class="bg-trading-card rounded-lg border border-trading-border p-4">
          <div class="text-2xl font-bold text-green-400">{{ activePatterns }}</div>
          <div class="text-sm text-gray-400">–ê–∫—Ç–∏–≤–Ω—ã—Ö</div>
        </div>
        <div class="bg-trading-card rounded-lg border border-trading-border p-4">
          <div class="text-2xl font-bold text-yellow-400">{{ categoriesCount }}</div>
          <div class="text-sm text-gray-400">–ö–∞—Ç–µ–≥–æ—Ä–∏–π</div>
        </div>
        <div class="bg-trading-card rounded-lg border border-trading-border p-4">
          <div class="text-2xl font-bold text-purple-400">{{ totalPatterns - activePatterns }}</div>
          <div class="text-sm text-gray-400">–ù–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö</div>
        </div>
      </div>

      <!-- Filters -->
      <div class="bg-trading-card rounded-lg border border-trading-border p-4 mb-6">
        <div class="flex flex-wrap gap-4">
          <div class="flex-1 min-w-[200px]">
            <input
              v-model="searchQuery"
              placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é..."
              class="w-full px-3 py-2 bg-trading-bg border border-trading-border rounded text-white"
            >
          </div>
          <select
            v-model="selectedCategory"
            class="px-3 py-2 bg-trading-bg border border-trading-border rounded text-white"
          >
            <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
            <option v-for="cat in categories" :key="cat" :value="cat">
              {{ getCategoryLabel(cat) }}
            </option>
          </select>
          <label class="flex items-center gap-2 px-3 py-2 bg-trading-bg border border-trading-border rounded cursor-pointer">
            <input
              v-model="activeOnly"
              type="checkbox"
              class="rounded"
            >
            <span class="text-white">–¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ</span>
          </label>
        </div>
      </div>

      <!-- Loading -->
      <div v-if="loading" class="text-center py-12">
        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-trading-green mx-auto mb-4"></div>
        <div class="text-gray-400">–ó–∞–≥—Ä—É–∑–∫–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤...</div>
      </div>

      <!-- Patterns List -->
      <div v-else class="grid grid-cols-1 gap-4">
        <div
          v-for="pattern in filteredPatterns"
          :key="pattern.id"
          class="bg-trading-card rounded-lg border border-trading-border p-6 hover:border-trading-green transition-colors"
        >
          <div class="flex justify-between items-start mb-4">
            <div class="flex-1">
              <div class="flex items-center gap-3 mb-2">
                <h3 class="text-xl font-semibold text-white">{{ pattern.name }}</h3>
                <span
                  class="px-2 py-1 rounded text-xs font-medium"
                  :class="getCategoryColor(pattern.category)"
                >
                  {{ getCategoryLabel(pattern.category) }}
                </span>
                <span
                  class="px-2 py-1 rounded text-xs font-medium"
                  :class="pattern.is_active ? 'bg-green-600 text-white' : 'bg-gray-600 text-gray-300'"
                >
                  {{ pattern.is_active ? '‚úì –ê–∫—Ç–∏–≤–µ–Ω' : '‚úó –ù–µ–∞–∫—Ç–∏–≤–µ–Ω' }}
                </span>
              </div>
              <p v-if="pattern.description" class="text-gray-400 text-sm mb-3">
                {{ pattern.description }}
              </p>
              <div class="bg-trading-bg rounded p-3 font-mono text-sm text-gray-300 overflow-x-auto">
                {{ pattern.pattern }}
              </div>
            </div>
          </div>

          <!-- Actions -->
          <div class="flex gap-2 mt-4">
            <button
              @click="togglePattern(pattern)"
              class="px-3 py-1 rounded text-sm transition-colors"
              :class="pattern.is_active 
                ? 'bg-gray-600 hover:bg-gray-700 text-white' 
                : 'bg-green-600 hover:bg-green-700 text-white'"
            >
              {{ pattern.is_active ? '‚úó –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å' : '‚úì –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å' }}
            </button>
            <button
              @click="testPattern(pattern)"
              class="px-3 py-1 bg-blue-600 hover:bg-blue-700 rounded text-sm text-white transition-colors"
            >
              üß™ –¢–µ—Å—Ç –Ω–∞ —Ç–µ–∫—Å—Ç–µ
            </button>
            <button
              @click="testPatternOnMessages(pattern)"
              :disabled="testingPatternId === pattern.id"
              class="px-3 py-1 bg-purple-600 hover:bg-purple-700 rounded text-sm text-white transition-colors disabled:opacity-50"
            >
              {{ testingPatternId === pattern.id ? '‚è≥ –¢–µ—Å—Ç–∏—Ä—É–µ–º...' : 'üìä –¢–µ—Å—Ç –Ω–∞ 1000 —Å–æ–æ–±—â–µ–Ω–∏—è—Ö' }}
            </button>
            <button
              @click="editPattern(pattern)"
              class="px-3 py-1 bg-yellow-600 hover:bg-yellow-700 rounded text-sm text-white transition-colors"
            >
              ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å
            </button>
            <button
              @click="deletePattern(pattern)"
              class="px-3 py-1 bg-red-600 hover:bg-red-700 rounded text-sm text-white transition-colors"
            >
              üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
            </button>
          </div>
        </div>

        <!-- Empty State -->
        <div v-if="filteredPatterns.length === 0" class="text-center py-12">
          <div class="text-gray-400 text-lg">–ü–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>
          <button
            @click="showCreateModal = true"
            class="mt-4 px-4 py-2 bg-trading-green hover:bg-opacity-80 rounded-lg transition-colors"
          >
            ‚ûï –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω
          </button>
        </div>
      </div>
    </div>

    <!-- Create/Edit Modal -->
    <div
      v-if="showCreateModal || editingPattern"
      class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4"
      @click.self="closeModal"
    >
      <div class="bg-trading-card rounded-lg border border-trading-border p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto">
        <h2 class="text-2xl font-bold text-white mb-4">
          {{ editingPattern ? '‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω' : '‚ûï –°–æ–∑–¥–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω' }}
        </h2>

        <div class="space-y-4">
          <!-- Name -->
          <div>
            <label class="block text-sm font-medium text-gray-300 mb-2">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
            <input
              v-model="formData.name"
              placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Ticker detection"
              class="w-full px-3 py-2 bg-trading-bg border border-trading-border rounded text-white"
            >
          </div>

          <!-- Category -->
          <div>
            <label class="block text-sm font-medium text-gray-300 mb-2">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
            <select
              v-model="formData.category"
              class="w-full px-3 py-2 bg-trading-bg border border-trading-border rounded text-white"
            >
              <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
              <option value="ticker">Ticker</option>
              <option value="direction_long">Direction: Long</option>
              <option value="direction_short">Direction: Short</option>
              <option value="operation_exit">Operation: Exit</option>
              <option value="trading_keyword">Trading Keyword</option>
              <option value="author">Author</option>
              <option value="price_target">Price: Target</option>
              <option value="price_stop">Price: Stop</option>
              <option value="price_take">Price: Take</option>
              <option value="garbage">Garbage</option>
            </select>
          </div>

          <!-- Pattern -->
          <div>
            <label class="block text-sm font-medium text-gray-300 mb-2">–†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ</label>
            <textarea
              v-model="formData.pattern"
              placeholder="(?:^|\s)\$([A-Z]{4,6})(?:\s|$)"
              rows="3"
              class="w-full px-3 py-2 bg-trading-bg border border-trading-border rounded text-white font-mono text-sm"
            ></textarea>
            <p class="text-xs text-gray-500 mt-1">Python regex —Å–∏–Ω—Ç–∞–∫—Å–∏—Å</p>
          </div>

          <!-- Description -->
          <div>
            <label class="block text-sm font-medium text-gray-300 mb-2">–û–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
            <textarea
              v-model="formData.description"
              placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞..."
              rows="2"
              class="w-full px-3 py-2 bg-trading-bg border border-trading-border rounded text-white"
            ></textarea>
          </div>

          <!-- Priority -->
          <div>
            <label class="block text-sm font-medium text-gray-300 mb-2">
              –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: {{ formData.priority }}
            </label>
            <input
              v-model.number="formData.priority"
              type="range"
              min="1"
              max="100"
              class="w-full"
            >
            <p class="text-xs text-gray-500 mt-1">–ß–µ–º –≤—ã—à–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç, —Ç–µ–º —Ä–∞–Ω—å—à–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è</p>
          </div>

          <!-- Active -->
          <label class="flex items-center gap-2 cursor-pointer">
            <input
              v-model="formData.is_active"
              type="checkbox"
              class="rounded"
            >
            <span class="text-white">–ê–∫—Ç–∏–≤–µ–Ω</span>
          </label>
        </div>

        <!-- Actions -->
        <div class="flex gap-3 mt-6">
          <button
            @click="savePattern"
            :disabled="!isFormValid || saving"
            class="flex-1 px-4 py-2 bg-trading-green hover:bg-opacity-80 rounded-lg transition-colors disabled:opacity-50"
          >
            {{ saving ? '‚è≥ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...' : 'üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å' }}
          </button>
          <button
            @click="closeModal"
            class="px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded-lg transition-colors"
          >
            ‚úï –û—Ç–º–µ–Ω–∞
          </button>
        </div>
      </div>
    </div>

    <!-- Test on Text Modal -->
    <div
      v-if="testingPattern"
      class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4"
      @click.self="testingPattern = null"
    >
      <div class="bg-trading-card rounded-lg border border-trading-border p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto">
        <h2 class="text-2xl font-bold text-white mb-4">
          üß™ –¢–µ—Å—Ç –ø–∞—Ç—Ç–µ—Ä–Ω–∞: {{ testingPattern.name }}
        </h2>

        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-300 mb-2">–¢–µ—Å—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç</label>
          <textarea
            v-model="testText"
            placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏..."
            rows="6"
            class="w-full px-3 py-2 bg-trading-bg border border-trading-border rounded text-white font-mono text-sm"
          ></textarea>
        </div>

        <div class="flex gap-2 mb-4">
          <button
            @click="runTextTest"
            :disabled="!testText || testing"
            class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors disabled:opacity-50"
          >
            {{ testing ? '‚è≥ –¢–µ—Å—Ç–∏—Ä—É–µ–º...' : '‚ñ∂Ô∏è –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç' }}
          </button>
          <button
            @click="loadExample"
            class="px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded-lg transition-colors"
          >
            üìù –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∏–º–µ—Ä
          </button>
        </div>

        <!-- Test Results -->
        <div v-if="testResults" class="bg-trading-bg rounded p-4">
          <h3 class="font-semibold text-white mb-2">
            –†–µ–∑—É–ª—å—Ç–∞—Ç: {{ testResults.matches_count }} —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
          </h3>
          <div v-if="testResults.matches && testResults.matches.length > 0" class="space-y-2">
            <div
              v-for="(match, idx) in testResults.matches"
              :key="idx"
              class="bg-trading-card p-3 rounded border border-trading-border"
            >
              <div class="font-mono text-green-400">{{ match.match }}</div>
              <div class="text-xs text-gray-500 mt-1">
                Position: {{ match.start }}-{{ match.end }}
                <span v-if="match.groups && match.groups.length">
                  | Groups: {{ match.groups.join(', ') }}
                </span>
              </div>
            </div>
          </div>
          <div v-else class="text-gray-400">–°–æ–≤–ø–∞–¥–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>
        </div>

        <button
          @click="testingPattern = null"
          class="mt-4 px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded-lg transition-colors"
        >
          ‚úï –ó–∞–∫—Ä—ã—Ç—å
        </button>
      </div>
    </div>

    <!-- Test on Messages Modal -->
    <div
      v-if="messagesTestResults"
      class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4"
      @click.self="messagesTestResults = null"
    >
      <div class="bg-trading-card rounded-lg border border-trading-border p-6 max-w-6xl w-full max-h-[90vh] overflow-y-auto">
        <h2 class="text-2xl font-bold text-white mb-4">
          üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
        </h2>

        <div class="grid grid-cols-3 gap-4 mb-6">
          <div class="bg-trading-bg rounded-lg p-4">
            <div class="text-2xl font-bold text-blue-400">{{ messagesTestResults.messages_tested }}</div>
            <div class="text-sm text-gray-400">–°–æ–æ–±—â–µ–Ω–∏–π –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ</div>
          </div>
          <div class="bg-trading-bg rounded-lg p-4">
            <div class="text-2xl font-bold text-green-400">{{ messagesTestResults.matches_found }}</div>
            <div class="text-sm text-gray-400">–°–æ–≤–ø–∞–¥–µ–Ω–∏–π –Ω–∞–π–¥–µ–Ω–æ</div>
          </div>
          <div class="bg-trading-bg rounded-lg p-4">
            <div class="text-2xl font-bold text-yellow-400">
              {{ Math.round((messagesTestResults.matches_found / messagesTestResults.messages_tested) * 100) }}%
            </div>
            <div class="text-sm text-gray-400">–ü—Ä–æ—Ü–µ–Ω—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è</div>
          </div>
        </div>

        <div v-if="messagesTestResults.matches && messagesTestResults.matches.length > 0" class="space-y-3">
          <h3 class="font-semibold text-white">–ù–∞–π–¥–µ–Ω–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è:</h3>
          <div
            v-for="match in messagesTestResults.matches"
            :key="match.message_id"
            class="bg-trading-bg rounded-lg p-4 border border-trading-border"
          >
            <div class="flex justify-between items-start mb-2">
              <div class="text-sm text-gray-400">
                {{ match.author }} ‚Ä¢ {{ formatDate(match.timestamp) }}
              </div>
              <div class="text-xs text-green-400 font-semibold">
                {{ match.match_count }} —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
              </div>
            </div>
            <div class="text-white text-sm mb-2 whitespace-pre-wrap">{{ match.text }}</div>
            <div class="space-y-1">
              <div
                v-for="(m, idx) in match.matches"
                :key="idx"
                class="text-xs bg-green-900 bg-opacity-30 text-green-400 px-2 py-1 rounded font-mono inline-block mr-2"
              >
                {{ m.matched_text }}
              </div>
            </div>
          </div>
        </div>
        <div v-else class="text-center py-8 text-gray-400">
          –°–æ–≤–ø–∞–¥–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
        </div>

        <button
          @click="messagesTestResults = null"
          class="mt-4 px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded-lg transition-colors"
        >
          ‚úï –ó–∞–∫—Ä—ã—Ç—å
        </button>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, computed, onMounted } from 'vue'
import { tradingAPI } from '../services/api'

// State
const loading = ref(false)
const saving = ref(false)
const testing = ref(false)
const isReparsing = ref(false)
const testingPatternId = ref(null)

const patterns = ref([])
const searchQuery = ref('')
const selectedCategory = ref('')
const activeOnly = ref(false)

const showCreateModal = ref(false)
const editingPattern = ref(null)
const testingPattern = ref(null)
const testText = ref('')
const testResults = ref(null)
const messagesTestResults = ref(null)

const formData = ref({
  name: '',
  category: '',
  pattern: '',
  description: '',
  priority: 50,
  is_active: true
})

// Computed
const categories = computed(() => {
  const cats = new Set(patterns.value.map(p => p.category))
  return Array.from(cats).sort()
})

const totalPatterns = computed(() => patterns.value.length)
const activePatterns = computed(() => patterns.value.filter(p => p.is_active).length)
const categoriesCount = computed(() => categories.value.length)

const filteredPatterns = computed(() => {
  let filtered = patterns.value

  if (searchQuery.value) {
    const search = searchQuery.value.toLowerCase()
    filtered = filtered.filter(p =>
      p.name.toLowerCase().includes(search) ||
      p.pattern.toLowerCase().includes(search) ||
      (p.description && p.description.toLowerCase().includes(search))
    )
  }

  if (selectedCategory.value) {
    filtered = filtered.filter(p => p.category === selectedCategory.value)
  }

  if (activeOnly.value) {
    filtered = filtered.filter(p => p.is_active)
  }

  return filtered.sort((a, b) => {
    if (a.is_active !== b.is_active) return b.is_active - a.is_active
    if (a.category !== b.category) return a.category.localeCompare(b.category)
    return b.priority - a.priority
  })
})

const isFormValid = computed(() => {
  return formData.value.name.trim() &&
    formData.value.category &&
    formData.value.pattern.trim()
})

// Methods
async function loadPatterns() {
  loading.value = true
  try {
    const response = await tradingAPI.get('/api/patterns')
    patterns.value = response.data.patterns || []
  } catch (error) {
    console.error('Failed to load patterns:', error)
    alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤')
  } finally {
    loading.value = false
  }
}

async function togglePattern(pattern) {
  try {
    await tradingAPI.togglePattern(pattern.id)
    pattern.is_active = !pattern.is_active
  } catch (error) {
    console.error('Failed to toggle pattern:', error)
    alert('–û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞')
  }
}

function editPattern(pattern) {
  editingPattern.value = pattern
  formData.value = {
    name: pattern.name,
    category: pattern.category,
    pattern: pattern.pattern,
    description: pattern.description || '',
    priority: pattern.priority,
    is_active: pattern.is_active
  }
}

async function savePattern() {
  if (!isFormValid.value) return

  saving.value = true
  try {
    if (editingPattern.value) {
      await tradingAPI.put(`/api/patterns/${editingPattern.value.id}`, formData.value)
    } else {
      await tradingAPI.post('/api/patterns', formData.value)
    }
    await loadPatterns()
    closeModal()
  } catch (error) {
    console.error('Failed to save pattern:', error)
    alert('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ' + error.message)
  } finally {
    saving.value = false
  }
}

async function deletePattern(pattern) {
  if (!confirm(`–£–¥–∞–ª–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω "${pattern.name}"?`)) return

  try {
    await tradingAPI.delete(`/api/patterns/${pattern.id}`)
    await loadPatterns()
  } catch (error) {
    console.error('Failed to delete pattern:', error)
    alert('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è')
  }
}

function testPattern(pattern) {
  testingPattern.value = pattern
  testText.value = ''
  testResults.value = null
}

async function runTextTest() {
  if (!testText.value) return

  testing.value = true
  testResults.value = null

  try {
    const response = await tradingAPI.testPattern({
      pattern: testingPattern.value.pattern,
      text: testText.value
    })
    testResults.value = response
  } catch (error) {
    console.error('Failed to test pattern:', error)
    alert('–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è')
  } finally {
    testing.value = false
  }
}

async function testPatternOnMessages(pattern) {
  testingPatternId.value = pattern.id

  try {
    const response = await tradingAPI.testPatternOnMessages(pattern.id, 1000)
    messagesTestResults.value = response
  } catch (error) {
    console.error('Failed to test on messages:', error)
    alert('–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö: ' + error.message)
  } finally {
    testingPatternId.value = null
  }
}

async function reparseAllMessages() {
  if (!confirm('–ü–µ—Ä–µ–ø–∞—Ä—Å–∏—Ç—å –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è? –≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –≤—Ä–µ–º—è.')) return

  const force = confirm(
    '–£–¥–∞–ª–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–∏–≥–Ω–∞–ª—ã –ø–µ—Ä–µ–¥ —Ä–µ–ø–∞—Ä—Å–∏–Ω–≥–æ–º?\n\n' +
    '–î–ê = —É–¥–∞–ª–∏—Ç—å –∏ —Å–æ–∑–¥–∞—Ç—å –∑–∞–Ω–æ–≤–æ\n' +
    '–ù–ï–¢ = –¥–æ–±–∞–≤–∏—Ç—å –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º'
  )

  isReparsing.value = true

  try {
    const result = await tradingAPI.reparseAllMessages(force)
    alert(
      `–†–µ–ø–∞—Ä—Å–∏–Ω–≥ –∑–∞–ø—É—â–µ–Ω!\n\n` +
      `–°–æ–æ–±—â–µ–Ω–∏–π: ${result.total_messages}\n` +
      `–†–µ–∂–∏–º: ${force ? '–ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞' : '–î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ'}`
    )
  } catch (error) {
    console.error('Failed to start reparse:', error)
    alert('–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ —Ä–µ–ø–∞—Ä—Å–∏–Ω–≥–∞: ' + error.message)
  } finally {
    setTimeout(() => {
      isReparsing.value = false
    }, 5000)
  }
}

function loadExample() {
  const examples = {
    'ticker': '$SBER –∫—É–ø–∏–ª –ø–æ 250‚ÇΩ\n$GAZP long entry',
    'direction_long': '–í—Ö–æ–¥ –ª–æ–Ω–≥ –ø–æ 100‚ÇΩ –æ—Ç —Ç–µ–∫—É—â–∏—Ö\n–æ—Ç–∫—Ä—ã–ª –ª–æ–Ω–≥',
    'direction_short': '–û—Ç–∫—Ä—ã–ª —à–æ—Ä—Ç –ø–æ 50\nshort position',
    'operation_exit': '–ó–∞–∫—Ä—ã–ª –ª–æ–Ω–≥ —Å –ø—Ä–æ—Ñ–∏—Ç–æ–º\nexit short',
    'trading_keyword': '–û—Ç–∫—Ä—ã—Ç–∞ –ø–æ–∑–∏—Ü–∏—è –Ω–∞ –ª–æ–Ω–≥\n–≤–æ—à–µ–ª –≤ —Å–¥–µ–ª–∫—É',
    'author': '#TraderPro - —Å–∏–≥–Ω–∞–ª –Ω–∞ –ø–æ–∫—É–ø–∫—É\n@TradingMaster',
    'price_target': '–¶–µ–ª—å: 300‚ÇΩ, —Å—Ç–æ–ø: 240‚ÇΩ\ntarget 120',
    'price_stop': '–°—Ç–æ–ø –ø–æ –ª–æ–Ω–≥—É: 95‚ÇΩ\nstop loss at 50',
    'price_take': '–¢–µ–π–∫ –ø—Ä–æ—Ñ–∏—Ç: 120‚ÇΩ\ntake profit 300',
    'garbage': '–ë–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –∫–∞–Ω–∞–ª–µ @copybot'
  }

  const category = testingPattern.value.category
  const example = examples[category] || '–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏'

  testText.value = `${example}\n\n$SBER –ª–æ–Ω–≥ –ø–æ 250‚ÇΩ\n–¶–µ–ª—å: 280‚ÇΩ\n–°—Ç–æ–ø: 240‚ÇΩ\n\n#Trader - —Å–¥–µ–ª–∫–∞ –¥–Ω—è`
}

function closeModal() {
  showCreateModal.value = false
  editingPattern.value = null
  formData.value = {
    name: '',
    category: '',
    pattern: '',
    description: '',
    priority: 50,
    is_active: true
  }
}

function getCategoryLabel(category) {
  const labels = {

=== –ö–û–î –û–ë–†–´–í–ê–ï–¢–°–Ø. –ü–†–û–î–û–õ–ñ–ï–ù–ò–ï –í –°–õ–ï–î–£–Æ–©–ï–ú –§–ê–ô–õ–ï ===

